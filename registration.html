<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <head>

        <!-- Google tag (gtag.js) -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-EMHX2RMVVC"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag() { dataLayer.push(arguments); }
            gtag('js', new Date());
            gtag('config', 'G-EMHX2RMVVC');
        </script>

        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />

        <title>Student Registration & Admission Form | Vintech Computer Education</title>


        <meta name="description"
            content="Apply online for admission at Vintech Computer Education. Fill the official student registration form for computer courses, diploma programs, scholarship-based admissions, and IT training in Bareilly, Uttar Pradesh." />

        <meta name="keywords"
            content="Vintech Computer Education registration, VCE admission form, computer course enrollment, IT institute admission Bareilly, scholarship admission form, diploma registration, Vintech enroll now" />

        <meta name="author" content="Vintech Computer Education" />
        <meta name="robots" content="index, follow" />


        <link rel="canonical" href="https://vintecheducation.org/registration.html" />


        <meta property="og:type" content="website" />
        <meta property="og:title" content="Student Registration | Vintech Computer Education" />
        <meta property="og:description"
            content="Official student enrollment and admission form for Vintech Computer Education. Register online for computer courses, diploma programs, and scholarship admissions." />
        <meta property="og:image" content="https://vintecheducation.org/images/og-banner.png" />
        <meta property="og:url" content="https://vintecheducation.org/registration.html" />
        <meta property="og:site_name" content="Vintech Computer Education" />
        <meta property="og:locale" content="en_IN" />

        <meta name="twitter:card" content="summary_large_image" />
        <meta name="twitter:title" content="Student Registration | Vintech Computer Education" />
        <meta name="twitter:description"
            content="Enroll online at Vintech Computer Education. Submit the official student registration form for IT and computer diploma courses." />
        <meta name="twitter:image" content="https://vintecheducation.org/images/og-banner.png" />


        <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@graph": [
      {
        "@type": "EducationalOrganization",
        "@id": "https://vintecheducation.org#organization",
        "name": "Vintech Computer Education",
        "url": "https://vintecheducation.org",
        "logo": "https://vintecheducation.org/images/og-banner.png",
        "email": "contact@vintecheducation.org",
        "address": {
          "@type": "PostalAddress",
          "streetAddress": "9FJ9+7W, opp. RAMAYAN VATIKA, Chandpur Bichpuri, Bareilly, Uttar Pradesh 243006",
          "addressLocality": "Bareilly",
          "addressRegion": "Uttar Pradesh",
          "postalCode": "243006",
          "addressCountry": "IN"
        }
      },
      {
        "@type": "WebPage",
        "@id": "https://vintecheducation.org/registration.html",
        "url": "https://vintecheducation.org/registration.html",
        "name": "Student Registration & Admission Form",
        "description": "Official student registration page for enrolling in computer and IT courses at Vintech Computer Education.",
        "isPartOf": {
          "@id": "https://vintecheducation.org#website"
        }
      },
      {
        "@type": "WebSite",
        "@id": "https://vintecheducation.org#website",
        "url": "https://vintecheducation.org",
        "name": "Vintech Computer Education",
        "publisher": {
          "@id": "https://vintecheducation.org#organization"
        }
      }
    ]
  }
  </script>

        <!-- Styles & Assets -->
        <link rel="stylesheet" href="style.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
        <!-- Google Translate -->
        <script defer src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
        <script defer src="script.js"></script>

        <!-- Favicon -->
        <link rel="icon" type="image/png" href="favicon/favicon-96x96.png" sizes="96x96" />
        <link rel="icon" type="image/svg+xml" href="favicon/favicon.svg" />
        <link rel="shortcut icon" href="favicon/favicon.ico" />
        <link rel="apple-touch-icon" sizes="180x180" href="favicon/apple-touch-icon.png" />
        <link rel="manifest" href="favicon/site.webmanifest" />

    </head>

</head>

<body>
    <header class="header">
        <a href="#">
            <div class="logo">
                <h1 class="visually-hidden">Student Registration & Admission Form - Vintech Computer Education</h1>
                <h1 class="short" translate="no">VCE</h1>
                <p class="name" translate="no">VINTECH COMPUTER EDUCATION</p>
            </div>
        </a>
        <nav class="nav-bar">
            <a href="index.html">Home</a>
            <a href="registration.html">Enroll Now</a>
            <a href="gallery.html">Gallery</a>
            <a href="events.html">Events</a>
            <a href="scholarship.html">Scholarship</a>
            <a href="about.html">About Us</a>

        </nav>
        <div class="hamburger">
            ☰
        </div>
    </header>
    <div class="toggle-container">
        <p class="Back"><a href="index.html">Back</a></p>
        <div class="toggle" id="langToggle">
            <span class="notranslate">EN</span>
            <span class="notranslate">हिं</span>
            <div class="circle"></div>
        </div>
        <p class="EMI"><a href="https://shop.vintecheducation.org">Buy Laptop on EMI</a></p>
    </div>
    <div class="multi-form-container">
        <form id="multiStepForm">

            <div class="progress-bar">
                <div class="progress"></div>
            </div>

            <!-- STEP 1 -->
            <div class="form-step active">
                <h2>Personal Details</h2>

                <input type="text" placeholder="Student's Full Name" required />

                <select id='gender' required>
                    <option value="">Gender</option>
                    <option value="Male">Male</option>
                    <option value="Female">Female</option>
                    <option value="others">Other</option>
                </select>


                <input type="text" placeholder="Father's Name" required />
                <input type="text" placeholder="Mother's Name" required />
                <textarea placeholder="Address" required></textarea>
                <input type="email" placeholder="Email" required />
                <input type="tel" id="phone" placeholder="Phone Number" required />
                <small style="color: grey; margin-left:7px;">Date of Birth (DOB)</small>
                <input type="date" required />

                <input type="text" placeholder="Last Qualification / Class" required />
                <input type="text" placeholder="University / School / College" />
                <input type="text" placeholder="Percentage / Grade" />
                <select id="disabilityStatus" required>
                    <option value="">Any Disability?</option>
                    <option value="No">No</option>
                    <option value="Yes">Yes</option>
                </select>

                <input type="text" id="disabilityDetails" placeholder="Mention Disability Details"
                    style="display:none;" />


                <button type="button" class="next-btn">Next</button>
            </div>

            <!-- STEP 2 -->
            <div class="form-step">
                <h2>Marital & Employment Status</h2>


                <select id="maritalStatus">
                    <option value="">Marital Status</option>
                    <option>Married</option>
                    <option>Unmarried</option>
                </select>


                <input type="text" id="husbandName" placeholder="Husband's Name" style="display:none;" />


                <select id="employmentStatus">
                    <option value="">Employment Status</option>
                    <option>Employed</option>
                    <option>Unemployed</option>
                </select>


                <input type="text" id="candidateOccupation" placeholder="Your Occupation" style="display:none;" />

                <input type="text" id="parentOccupation" placeholder="Parent's Occupation" style="display:none;" />


                <div class="buttons">
                    <button type="button" class="prev-btn">Back</button>
                    <button type="button" class="next-btn">Next</button>
                </div>
            </div>

            <!-- STEP 3 -->
            <div class="form-step">
                <h2>Government ID & Documents</h2>

                <input type="text" placeholder="Aadhar Number" id="aadhar" inputmode="numeric" maxlength="12"
                    required />

                <label class="file-upload">
                    Upload Passport Size Photo
                    <input type="file" id="photoUpload" accept="image/png,image/jpeg" required />
                    <small>Only JPG/PNG • Max 2MB</small>
                    <p id="fileError" style="color:red; display:none; margin:5px 0;"></p>
                </label>




                <div class="buttons">
                    <button type="button" class="prev-btn">Back</button>
                    <button type="button" class="next-btn">Next</button>
                </div>
            </div>

            <!-- STEP 4 -->
            <div class="form-step">
                <h2>Course Information</h2>


                <select id="courseSelect" required>
                    <option value="">Select Course</option>
                    <option value="ADCA">ADCA</option>
                    <option value="MDCA">MDCA</option>
                    <option value="CCC">CCC</option>
                    <option value="DCST">DCST</option>
                    <option value="CCA">CCA</option>
                    <option value="fullstack">Full Stack Web Development</option>
                    <option value="aidevelopment">AI Development</option>
                    <option value="olevel">O LEVEL</option>
                    <option value="webdesigning">Web Designing</option>
                    <option value="dcaadcst">DCA+ADCST</option>
                    <option value="languages">Languages</option>
                    <option value="dcstadcst">DCST+ADCST</option>
                </select>

                <select id="branchSelect" required>
                    <option value="">Select Branch</option>
                    <option value="main">Main : 9FJ9+7W, opp. RAMAYAN VATIKA</option>
                    <option value="second">Second : Greater Green Park Colony</option>
                    <option value="third">Third : Umed Pur Puliya, Bhuta</option>
                </select>


                <select id="admissionType" required>
                    <option value="">Admission Type</option>
                    <option value="direct">Direct Admission</option>
                    <option value="scholarship">Scholarship Based</option>
                </select>

                <p id="rollStatus" class="roll-status"></p>
                <input type="text" id="examRollNumber" placeholder="Scholarship Exam Roll Number"
                    style="display:none;" />

                <select id="classDuration" required>
                    <option value="">Select Class Duration</option>
                </select>

                <input type="hidden" id="classDurationHidden" name="classDuration" />

                <p id="rollBlockMsg" style="color:red; display:none; margin-top:5px;"></p>

                <div class="buttons">
                    <button type="button" class="prev-btn">Back</button>
                    <button type="button" class="next-btn">Next</button>
                </div>
            </div>

            <!-- STEP 5 -->
            <div class="form-step">
                <h2>Payment Summary</h2>

                <div class="fee-breakdown">
                    <div class="fee-row">
                        <span>Total Course Fees</span>
                        <strong>₹ <span id="totalFees">0</span></strong>
                    </div>

                    <div class="fee-row">
                        <span>Fees / Month</span>
                        <strong>₹ <span id="monthlyFees">0</span></strong>
                    </div>



                    <div class="fee-row">
                        <span>Platform Fees</span>
                        <strong>₹ <span id="platformFees">10</span></strong>
                    </div>

                    <div class="fee-row">
                        <span style="color:green;">Scholarship Discount</span>
                        <strong style="color:green;">- <span id="scholarshipDiscount">0</span></strong>
                    </div>

                    <hr />

                    <div class="fee-row total">
                        <span>Amount Payable Now</span>
                        <strong>₹ <span id="finalAmount">0</span></strong>
                    </div>
                </div>

                <div class='pay-options' style="margin:15px 0;">
                    <button type="button" class="upi-btn" data-upi="link">Pay Using UPI Link</button>
                    <button type="button" class="upi-btn" data-upi="qr">Pay Using QR Code</button>
                </div>

                <div id="upiAction" style="display:none; margin-top:10px;"></div>

                <p id="act-msg" style="color:red; margin-top:10px; text-align: center;">
                    ⚠️ Please take a screenshot after payment, keep it safe! And submit the form.
                </p>
                <div class="buttons">
                    <button type="button" class="prev-btn">Back</button>
                    <button type="submit" class="submit-btn">Submit</button>
                </div>
            </div>



        </form>
        <!-- Success Modal -->
        <div id="successModal" class="success-overlay">
            <div class="success-box">
                <div class="success-icon">
                    ✓
                </div>

                <h2>Registration Submitted</h2>
                <p>
                    Your registration form has been submitted.<br />
                    You need to visit us offline at the branch address you selected for final confirmation.
                </p>

                <button class="close-btn" onclick="location.href='index.html'">
                    Okay
                </button>
            </div>
        </div>

    </div>
    <footer>
        <div class="footer-left">
            <p>&copy; 2025 Vintech Computer Education. All Rights Reserved.</p>
            <p>Created By
                <a href="https://mukundvishwa95.github.io/" target="_blank" rel="noopener noreferrer">
                    Mukund Vishwakarma
                </a>
            </p>
        </div>

        <div class="footer-center">
            <h4>Classes Schedule</h4>
            <p>Monday – Saturday: 8:00 AM – 8:00 PM</p>
            <p>Sunday: Closed</p>
        </div>

        <div class="footer-right">
            <a href="privacypolicy.html">
                <p>Privacy Policy</p>
            </a>
            <a href="faculty.html">
                <p>Meet our Team</p>
            </a>
            <a href="t&c.html">
                <p>Terms & Conditions</p>
            </a>
            <div class="footer-social">
                <a href="https://g.page/r/CUA8zTtbBSNwEBM/review" target="_blank"><i class="fab fa-google"></i></a>
                <a href="https://www.linkedin.com/company/vintech-computer-education" target="_blank"><i
                        class="fab fa-linkedin"></i></a>
                <a href="https://t.me/vc_edu" target="_blank"><i class="fab fa-telegram"></i></a>
                <a href="mailto:support@vintecheducation.org" target="_blank"><i class="fa-solid fa-envelope"></i></a>
                <a href="https://www.youtube.com/@VCE-w1e" target="_blank"><i class="fab fa-youtube"></i></a>
            </div>
        </div>
    </footer>

    <script>
        let compressedPhotoBlob = null;
        let compressedFileName = null;

        document.querySelectorAll("input[type='text']:not([type='email']), textarea")
            .forEach(inp => {
                inp.style.textTransform = "uppercase";
                inp.addEventListener("input", () => {
                    inp.value = inp.value.toUpperCase();
                });
            });

        /* =============================
           MULTI STEP FORM
        ============================= */
        const steps = document.querySelectorAll(".form-step");
        const nextBtns = document.querySelectorAll(".next-btn");
        const prevBtns = document.querySelectorAll(".prev-btn");
        const progress = document.querySelector(".progress");
        const rollBlockMsg = document.getElementById("rollBlockMsg");
        let currentStep = 0;

        function updateStep() {
            steps.forEach((step, i) => {
                step.classList.toggle("active", i === currentStep);
            });
            progress.style.width = ((currentStep + 1) / steps.length) * 100 + "%";
        }

        nextBtns.forEach(btn => {
            btn.addEventListener("click", () => {
                if (currentStep === 3 &&
                    admissionType.value === "scholarship" &&
                    !rollValid) {
                    rollBlockMsg.style.display = "block";
                    rollBlockMsg.textContent =
                        "Roll Number invalid. Enter valid Roll Number or select Direct Admission.";
                    return;
                }
                const inputs = steps[currentStep].querySelectorAll("input, select, textarea");

                for (let input of inputs) {
                    if (input.offsetParent === null) continue;
                    if (!input.checkValidity()) {
                        input.reportValidity();
                        return;
                    }
                }

                if (currentStep < steps.length - 1) {
                    currentStep++;
                    updateStep();
                }
            });
        });

        prevBtns.forEach(btn => {
            btn.addEventListener("click", () => {
                if (currentStep > 0) {
                    currentStep--;
                    updateStep();
                }
            });
        });

        updateStep();

        /* =============================
           CONDITIONAL FIELDS
        ============================= */

        const phone = document.querySelector("#phone");
        phone.addEventListener("input", () => {
            phone.value = phone.value.replace(/\D/g, "");

            if (phone.value.length < 10) {
                phone.setCustomValidity("Enter valid 10 digit mobile number");
            } else {
                phone.setCustomValidity("");
            }
        });

        const dobInput = document.querySelector("input[type='date']");

        dobInput.addEventListener("change", () => {
            const dob = new Date(dobInput.value);
            if (!dob) return;

            const today = new Date();

            if (dob > today) {
                dobInput.setCustomValidity("DOB cannot be in future");
                return;
            }
            let age = today.getFullYear() - dob.getFullYear();
            const m = today.getMonth() - dob.getMonth();

            if (m < 0 || (m === 0 && today.getDate() < dob.getDate())) {
                age--;
            }

            if (age < 10) {
                dobInput.setCustomValidity("Student must be at least 10 years old");
            } else {
                dobInput.setCustomValidity("");
            }
        });


        const disabilityStatus = document.getElementById("disabilityStatus");
        const disabilityDetails = document.getElementById("disabilityDetails");

        function toggleDisability() {
            if (disabilityStatus.value === "Yes") {
                disabilityDetails.style.display = "block";
                disabilityDetails.required = true;
            } else {
                disabilityDetails.style.display = "none";
                disabilityDetails.required = false;
                disabilityDetails.value = "";
            }
        }

        disabilityStatus.addEventListener("change", toggleDisability);


        const gender = document.getElementById("gender");
        const maritalStatus = document.getElementById("maritalStatus");
        const husbandName = document.getElementById("husbandName");

        const employmentStatus = document.getElementById("employmentStatus");
        const candidateOccupation = document.getElementById("candidateOccupation");
        const parentOccupation = document.getElementById("parentOccupation");

        function toggleHusbandName() {
            if (gender.value === "Female" && maritalStatus.value === "Married") {
                husbandName.style.display = "block";
                husbandName.required = true;
            } else {
                husbandName.style.display = "none";
                husbandName.required = false;
                husbandName.value = "";
            }
        }

        function toggleOccupation() {
            if (employmentStatus.value === "Employed") {
                candidateOccupation.style.display = "block";
                candidateOccupation.required = true;
                parentOccupation.style.display = "none";
                parentOccupation.required = false;
                parentOccupation.value = "";
            } else if (employmentStatus.value === "Unemployed") {
                parentOccupation.style.display = "block";
                parentOccupation.required = true;
                candidateOccupation.style.display = "none";
                candidateOccupation.required = false;
                candidateOccupation.value = "";
            } else {
                candidateOccupation.style.display = "none";
                parentOccupation.style.display = "none";
            }
        }

        gender.addEventListener("change", toggleHusbandName);
        maritalStatus.addEventListener("change", toggleHusbandName);
        employmentStatus.addEventListener("change", toggleOccupation);


        const aadharInput = document.querySelector("#aadhar");
        aadharInput.addEventListener("input", () => {
            aadharInput.value = aadharInput.value.replace(/\D/g, "");

            if (aadharInput.value.length !== 12) {
                aadharInput.setCustomValidity("Aadhar must be exactly 12 digits");
            } else {
                aadharInput.setCustomValidity("");
            }
        });

        /* =============================
         Photo Validation & Compression
        ============================= */
        const photoInput = document.getElementById("photoUpload");
        const fileError = document.getElementById("fileError");

        photoInput.addEventListener("change", async () => {
            const file = photoInput.files[0];
            fileError.style.display = "none";

            if (!file) return;
            console.log("Original Size:", (file.size / 1024).toFixed(2), "KB");

            if (!["image/jpeg", "image/png"].includes(file.type)) {
                fileError.textContent = "Only JPG or PNG allowed";
                fileError.style.display = "block";
                photoInput.value = "";
                return;
            }

            if (file.size > 2 * 1024 * 1024) {
                fileError.textContent = "File too large! Max 2MB";
                fileError.style.display = "block";
                photoInput.value = "";
                return;
            }

            fileError.style.display = "block";
            fileError.style.color = "orange";
            fileError.textContent = "Compressing...";

            compressedPhotoBlob = await compressImage(file);
            compressedFileName = `${Date.now()}.jpg`;
            console.log("Compressed Size:", (compressedPhotoBlob.size / 1024).toFixed(2), "KB");
            fileError.style.color = "green";
            fileError.textContent = "Uploaded";
        });
        function compressImage(file) {
            return new Promise((resolve) => {
                const img = new Image();
                img.src = URL.createObjectURL(file);

                img.onload = () => {
                    const MAX_WIDTH = 600;
                    const MAX_HEIGHT = 600;

                    let width = img.width;
                    let height = img.height;
                    console.log(width, height)

                    if (width > height && width > MAX_WIDTH) {
                        height *= MAX_WIDTH / width;
                        width = MAX_WIDTH;
                    } else if (height > MAX_HEIGHT) {
                        width *= MAX_HEIGHT / height;
                        height = MAX_HEIGHT;
                    }

                    const canvas = document.createElement("canvas");
                    canvas.width = width;
                    canvas.height = height;
                    console.log(width, height)

                    const ctx = canvas.getContext("2d");
                    ctx.drawImage(img, 0, 0, width, height);

                    canvas.toBlob(
                        (blob) => resolve(blob),
                        "image/jpeg",
                        0.7
                    );
                };
            });
        }


        /* =============================
           COURSE & DURATION
        ============================= */
        const courseSelect = document.getElementById("courseSelect");
        const admissionType = document.getElementById("admissionType");
        const examRollNumber = document.getElementById("examRollNumber");
        const classDuration = document.getElementById("classDuration");
        const classDurationHidden = document.getElementById("classDurationHidden");

        const courseDurations = {
            ADCA: ["14 Months", "7 Months", "4 Months"],
            MDCA: ["14 Months", "7 Months"],
            CCC: ["3 Months"],
            DCST: ["6 Months"],
            CCA: ["3 Months"],
            fullstack: ["6 Months"],
            aidevelopment: ["10 Months"],
            olevel: ["12 Months", "7 Months"],
            webdesigning: ["12 Months"],
            dcaadcst: ["4 Months"],
            languages: ["6 Months"],
            dcstadcst: ["10 Months"]
        };

        const courseFees = {
            ADCA: { "14 Months": 600, "7 Months": 1000, "4 Months": 2200 },
            MDCA: { "14 Months": 1100, "7 Months": 2200 },
            CCC: { "3 Months": 1000 },
            DCST: { "6 Months": 500 },
            CCA: { "3 Months": 1000 },
            fullstack: { "6 Months": 2200 },
            aidevelopment: { "10 Months": 3000 },
            olevel: { "12 Months": 1750, "7 Months": 3571.42 },
            webdesigning: { "12 Months": 1150 },
            dcaadcst: { "4 Months": 1500 },
            languages: { "6 Months": 1000 },
            dcstadcst: { "10 Months": 550 }
        };

        courseSelect.addEventListener("change", () => {
            const course = courseSelect.value;
            classDuration.innerHTML = `<option value="">Select Class Duration</option>`;
            classDuration.disabled = false;
            classDurationHidden.value = "";

            if (!courseDurations[course]) return;

            courseDurations[course].forEach(d => {
                classDuration.appendChild(new Option(d, d));
            });

            if (courseDurations[course].length === 1) {
                classDuration.value = courseDurations[course][0];
                classDurationHidden.value = courseDurations[course][0];
                classDuration.disabled = true;
                updateFeeBreakdown();
            }
        });

        classDuration.addEventListener("change", () => {
            classDurationHidden.value = classDuration.value;
            updateFeeBreakdown();
        });

        /* =============================
           SCHOLARSHIP
        ============================= */
        const step4NextBtn = steps[3].querySelector(".next-btn");
        let rollValid = false;

        function updateNextState() {
            if (admissionType.value === "scholarship") {
                step4NextBtn.classList.toggle("blocked", !rollValid);
            } else {
                step4NextBtn.classList.remove("blocked");
            }
        }

        admissionType.addEventListener("change", () => {
            if (admissionType.value === "scholarship") {
                examRollNumber.style.display = "block";
                examRollNumber.required = true;
                rollValid = false;
                updateNextState();
            } else {
                examRollNumber.style.display = "none";
                examRollNumber.required = false;
                examRollNumber.value = "";
                rollStatus.textContent = "";
                rollValid = true;
                scholarshipPercent = 0;
                updateNextState();
                rollBlockMsg.style.display = "none";
            }
        });

        const rollInput = document.getElementById("examRollNumber");
        const rollStatus = document.getElementById("rollStatus");
        let scholarshipPercent = 0;
        rollInput.addEventListener("input", () => {
            rollValid = false;
            updateNextState();
            rollStatus.textContent = "";
        });

        rollInput.addEventListener("blur", () => {
            const roll = rollInput.value.trim();
            if (!roll) return;

            rollInput.disabled = true;
            rollInput.classList.add("roll-checking");
            rollStatus.textContent = "Checking...";
            rollStatus.className = "roll-status";
            rollValid = false;
            updateNextState();

            fetch(`https://script.google.com/macros/s/AKfycbySLVD5LXVK1PyUo3X6dybmqiohAN4X8PPcdpH2YvXLMRsHA-aLIzGnkczqBm52ydUFmw/exec?roll=${roll}`)
                .then(res => res.json())
                .then(data => {
                    if (data.exists) {
                        rollValid = true;
                        rollStatus.textContent = "Valid Roll Number ✔";
                        rollStatus.className = "roll-status roll-success";
                        scholarshipPercent = getScholarshipPercent(Number(data.marks));
                        document.getElementById("scholarshipDiscount").textContent = scholarshipPercent + "%";


                        updateFeeBreakdown();
                    } else {
                        rollValid = false;
                        rollStatus.textContent = "Invalid or expired Roll Number";
                        rollStatus.className = "roll-status roll-failed";
                    }
                })
                .catch(() => {
                    rollValid = false;
                    rollStatus.textContent = "Network error. Try again.";
                    rollStatus.className = "roll-status roll-failed";
                })
                .finally(() => {
                    rollInput.disabled = false;
                    rollInput.classList.remove("roll-checking");
                    updateNextState();
                });
        });

        function getScholarshipPercent(marks) {
            if (marks >= 1 && marks <= 20) return 50;
            if (marks >= 21 && marks <= 40) return 60;
            if (marks >= 41 && marks <= 60) return 65;
            if (marks >= 61 && marks <= 70) return 70;
            if (marks >= 71 && marks <= 80) return 75;
            if (marks >= 81 && marks <= 90) return 100;
            if (marks >= 91 && marks <= 100) return 110;
            return 0;
        }

        /* =============================
           FEE BREAKDOWN
        ============================= */
        const totalFeesEl = document.getElementById("totalFees");
        const monthlyFeesEl = document.getElementById("monthlyFees");
        const finalAmountEl = document.getElementById("finalAmount");

        const PLATFORM_FEE = 10;

        const scholarshipText = document.getElementById("scholarshipDiscount");

        function updateFeeBreakdown() {
            const course = courseSelect.value;
            const duration = classDurationHidden.value;

            if (!course || !duration || !courseFees[course]?.[duration]) {
                totalFeesEl.textContent = "0";
                monthlyFeesEl.textContent = "0";
                finalAmountEl.textContent = "0";
                scholarshipText.textContent = "0%";
                return;
            }

            const monthlyFee = courseFees[course][duration];
            const months = parseInt(duration);
            const totalCourseFee = Math.round(monthlyFee * months);

            totalFeesEl.textContent = totalCourseFee;
            monthlyFeesEl.textContent = monthlyFee;
            const fee_to_discount = monthlyFee + PLATFORM_FEE;
            let discountedMonthly = fee_to_discount;

            if (admissionType.value === "scholarship" && scholarshipPercent > 0) {
                discountedMonthly = Math.max(
                    Math.round(fee_to_discount - (fee_to_discount * scholarshipPercent / 100)),
                    0
                );
            }
            const payOptions = document.querySelector(".pay-options");
            const act = document.querySelector("#act-msg");

            if (payOptions) {
                if (scholarshipPercent === 110 && admissionType.value === "scholarship") {
                    payOptions.style.display = "none";
                    act.style.display = "none";
                    finalAmountEl.textContent = 0;
                } else {
                    payOptions.style.display = "flex";
                    act.style.display = "block";
                }
            }



            const payableNow = discountedMonthly;

            finalAmountEl.textContent = payableNow;
        }
        if (admissionType.value === "scholarship" && scholarshipPercent > 0) {
            document.getElementById("scholarshipDiscount").textContent = scholarshipPercent + "%";
        }

        /* =============================
           URL COURSE PREFILL
        ============================= */
        const params = new URLSearchParams(window.location.search);
        const preCourse = params.get("course");

        if (preCourse) {
            const map = {
                adca: "ADCA",
                mdca: "MDCA",
                ccc: "CCC",
                dcst: "DCST",
                cca: "CCA",
                fullstack: "fullstack",
                aidevelopment: "aidevelopment",
                olevel: "olevel",
                webdesigning: "webdesigning",
                dcaadcst: "dcaadcst",
                languages: "languages",
                dcstadcst: "dcstadcst"
            };

            if (map[preCourse]) {
                courseSelect.value = map[preCourse];
                courseSelect.dispatchEvent(new Event("change"));
            }
        }

        /* =============================
   SIMPLE PAYMENT FLOW
============================= */
        const upiButtons = document.querySelectorAll(".upi-btn");
        const upiAction = document.getElementById("upiAction");

        upiButtons.forEach(btn => {
            btn.addEventListener("click", () => {
                const type = btn.dataset.upi;

                const studentName =
                    document.querySelector("input[placeholder=\"Student's Full Name\"]")?.value || "";
                const fatherName =
                    document.querySelector("input[placeholder=\"Father's Name\"]")?.value || "";
                const courseName = courseSelect.value || "";
                const amount = document.getElementById("finalAmount").textContent;

                const note =
                    `Student:${studentName} | Father:${fatherName} | Course:${courseName} | Paid:₹${amount}`;
                const encodedNote = encodeURIComponent(note);

                upiAction.style.display = "block";
                if (type === "qr") {
                    const upiString =
                        `upi://pay?pa=manishmont-1@okaxis&pn=VINTECH%20COMPUTER%20EDUCATION&am=${amount}&cu=INR&tn=${encodedNote}`;

                    const qrAPI =
                        `https://api.qrserver.com/v1/create-qr-code/?size=220x220&data=${encodeURIComponent(upiString)}`;

                    upiAction.innerHTML = `
                <div style="display:flex;flex-direction:column;align-items:center;text-align:center;">
                    <p><strong>Scan & Pay</strong></p>
                    <img src="${qrAPI}" style="max-width:220px;margin:10px 0;" />
                    <p>Amount: ₹${amount}</p>
                </div>
            `;
                }

                if (type === "link") {
                    const upiLink =
                        `upi://pay?pa=manishmont-1@okaxis&pn=VINTECH%20COMPUTER%20EDUCATION&am=${amount}&cu=INR&tn=${encodedNote}`;

                    window.location.href = upiLink;
                }
            });
        });

        /* =============================
           FORM SUBMIT
        ============================= */
        document.getElementById("multiStepForm").addEventListener("submit", async function (e) {
            e.preventDefault();

            const submitBtn = document.querySelector(".submit-btn");
            submitBtn.disabled = true;
            submitBtn.textContent = "Submitting...";

            try {

                if (!compressedPhotoBlob) {
                    alert("Please upload photo first");
                    submitBtn.disabled = false;
                    submitBtn.textContent = "Submit";
                    return;
                }

                const studentNameVal = document.querySelector("input[placeholder=\"Student's Full Name\"]")?.value || "student";
                const fatherNameVal = document.querySelector("input[placeholder=\"Father's Name\"]")?.value || "father";
                const courseVal = courseSelect?.value || "course";

                function safeText(str) {
                    return str
                        .trim()
                        .toLowerCase()
                        .replace(/[^a-z0-9]+/g, "_")
                        .replace(/^_+|_+$/g, "");
                }
                const today = new Date();
                const admissionDate = today.toISOString().split("T")[0].replace(/-/g, "");

                const fileName = `photos/${safeText(studentNameVal)
                    }_${safeText(fatherNameVal)
                    }_${safeText(courseVal)
                    }_${admissionDate
                    }_${Math.floor(Math.random() * 9999)
                    }.jpg`;


                const { data: uploadData, error: uploadError } = await supaBase
                    .storage
                    .from("student-photos")
                    .upload(fileName, compressedPhotoBlob, {
                        cacheControl: "3600",
                        upsert: false
                    });

                if (uploadError) {
                    console.log(uploadError);
                    alert("Photo upload failed. Try again");
                    submitBtn.disabled = false;
                    submitBtn.textContent = "Submit";
                    return;
                }

                const photoPath = uploadData.path;

                const studentName = document.querySelector("input[placeholder=\"Student's Full Name\"]").value;
                const genderVal = gender.value;
                const fatherName = document.querySelector("input[placeholder=\"Father's Name\"]").value;
                const motherName = document.querySelector("input[placeholder=\"Mother's Name\"]").value;
                const address = document.querySelector("textarea").value;
                const email = document.querySelector("input[type=email]").value;
                const phone = document.querySelector("input[type=tel]").value;
                const dob = document.querySelector("input[type=date]").value;
                const qualification = document.querySelector("input[placeholder='Last Qualification / Class']").value;
                const institute = document.querySelector("input[placeholder='University / School / College']").value;
                const percent = document.querySelector("input[placeholder='Percentage / Grade']").value;
                const aadhar = document.querySelector("input[placeholder='Aadhar Number']").value;

                const course = courseSelect.value;
                const duration = classDurationHidden.value;

                let baseMonthly = courseFees[course]?.[duration] || 0;

                let finalMonthly = baseMonthly;

                if (admissionType.value === "scholarship" && scholarshipPercent > 0) {
                    finalMonthly = Math.round(baseMonthly - (baseMonthly * scholarshipPercent / 100));

                    if (finalMonthly < 0) finalMonthly = 0;
                }

                const { data, error } = await supaBase
                    .from("student_admissions")
                    .insert([{
                        student_name: studentName,
                        gender: genderVal,
                        father_name: fatherName,
                        mother_name: motherName,
                        address,
                        email,
                        phone,
                        dob,
                        qualification,
                        institute_name: institute,
                        percentage: percent,

                        disability_status: disabilityStatus.value,
                        disability_details: disabilityDetails.value || null,

                        marital_status: maritalStatus.value,
                        husband_name: husbandName.value || null,
                        employment_status: employmentStatus.value,
                        candidate_occupation: candidateOccupation.value || null,
                        parent_occupation: parentOccupation.value || null,

                        aadhar,
                        photo_path: photoPath,

                        course_name: courseSelect.value,
                        branch: branchSelect.value,
                        admission_type: admissionType.value,
                        scholarship_roll: examRollNumber.value || null,
                        class_duration: classDurationHidden.value,

                        monthly_fee: finalMonthly
                    }]);

                if (error) {
                    console.log(error);

                    await supaBase.storage.from("student-photos").remove([photoPath]);

                    alert("Saving form failed. Try again!");
                    submitBtn.disabled = false;
                    submitBtn.textContent = "Submit";
                    return;
                }

                document.getElementById("successModal").style.display = "flex";

            } catch (err) {
                console.error(err);
                alert("Unexpected error occurred");
                submitBtn.disabled = false;
                submitBtn.textContent = "Submit";
            }
        });

    </script>
    <script src="https://unpkg.com/@supabase/supabase-js"></script>
    <script>
        const supaBase = supabase.createClient(
            "https://auygeiqcsygchfmitfxv.supabase.co",
            "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImF1eWdlaXFjc3lnY2hmbWl0Znh2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjcxMDUzOTEsImV4cCI6MjA4MjY4MTM5MX0.WVpNirNUPa3v3VP5vusjAFezPvH1C8ZF16dWRPcKH-4"
        );
    </script>


    <div id="google_translate_element" style="display:none;"></div>

</body>

</html>